import{gameData}from"../../Constants/gameData.js";import{vocabulary}from"../../Constants/vocabulary.js";import{vocabularyImgDtArr}from"../../Constants/ImagesData.js";import{colors}from"../../Constants/Colors.js";class Words{constructor(e){this.game=e,this.element=document.querySelector("#game_Container"),this.cards=[],this.cardIdx=0,document.title="Aprendendo Palavras!",gameData.mainScene="Words",this.game.resetContainerToNewScene("wd"),this.start()}start(){this.generateCards(),this.buildContainer(),this.game.playAudio(gameAssets.nature_ambience,1,!0),this.setContainerElement()}generateCards(){!function(e,t,a){for(let i=0;i<t;i+=a)e[i]=i;e.sort((()=>Math.random()-.5))}(this.cards,vocabulary.length,1)}buildContainer(){this.game.buildBg();const e=this.game.createNewElement("div","bg wd"),t=this.game.createNewElement("div","wd_main container"),a=this.game.createNewElement("div","wd_main_cardContainer container"),i=this.game.createNewElement("div","imgCard card container"),s=this.getImage(vocabularyImgDtArr[this.cards[this.cardIdx]].name);s.setAttribute("alt",vocabularyImgDtArr[this.cards[this.cardIdx]].alt);const r=this.game.createNewElement("div","vLibrasCard card"),n=document.querySelector(".access"),c=document.querySelector("[vw-access-button]"),d=this.game.createNewElement("p","p_title");d.setAttribute("id","pTitle");const o=this.game.createNewElement("p","p_imgDescri");let l;r.appendChild(n),a.append(i,r),t.appendChild(a),this.element.append(e,t),c.click(),gameData.wereVLibrasActived?(this.setCloseBtn(),d.innerHTML=vocabulary[this.cards[this.cardIdx]].palavra,o.innerHTML=`${vocabulary[this.cards[this.cardIdx]].descricao}`,l=this.game.createNewElement("div","imgTitle container"),l.appendChild(d),r.appendChild(n),i.appendChild(s),a.append(i,r),t.appendChild(a),this.element.append(e,t)):(gameData.isClickable=!1,setTimeout((()=>{i.appendChild(s),d.innerHTML=vocabulary[this.cards[this.cardIdx]].palavra,o.innerHTML=`${vocabulary[this.cards[this.cardIdx]].descricao}`,l.appendChild(d),this.setCloseBtn(),this.setSubtitle(),gameData.isClickable=!0,d.click()}),8e3),gameData.wereVLibrasActived=!0),n.style.display="block";const m=this.game.createNewElement("div","wd_main_middleBar container"),h=this.game.createNewElement("button","prevBtn wd_btn btn","prevBtn"),u=this.game.createNewElement("i","fa-solid fa-arrow-left");l||(l=this.game.createNewElement("div","imgTitle container"));const p=this.game.createNewElement("button","nextBtn wd_btn btn","nextBtn"),b=this.game.createNewElement("i","fa-solid fa-arrow-right");h.appendChild(u),p.appendChild(b),m.append(h,l,p),t.appendChild(m);const g=this.game.createNewElement("div","wd_footer container"),v=this.game.createNewElement("div","imgDescription container");v.appendChild(o),g.appendChild(v);for(let e=0;e<11;e++){let t=this.getImage(`grass${e+1}`);t.classList.add("wd-grass"),t.setAttribute("alt","grama"),g.appendChild(t)}this.element.append(e,t,g)}setContainerElement(){const e=document.querySelector("#prevBtn"),t=document.querySelector("#nextBtn");e.addEventListener("click",(e=>{gameData.isClickable&&(this.cardIdx<=0||(this.game.playAudio(gameAssets[gameAssets.btn_select]),this.cardIdx--,this.updateCards(),this.readWithAccessibility()))})),t.addEventListener("click",(()=>{gameData.isClickable&&(this.cardIdx>=vocabulary.length-1||(this.game.playAudio(gameAssets.btn_select),this.cardIdx++,this.updateCards(),this.readWithAccessibility()))})),document.addEventListener("keydown",(e=>{if("Words"===gameData.mainScene&&0!=gameData.isClickable)switch(e.key){case"ArrowLeft":if(this.cardIdx<=0)return;this.cardIdx--,this.updateCards();break;case"ArrowRight":if(this.cardIdx>=vocabulary.length-1)return;this.cardIdx++,this.updateCards();break;case"Enter":console.log("ArrowLeft"),this.readWithAccessibility();break;default:return}})),this.game.setBtns(document.querySelector(".wd_main_middleBar"))}readWithAccessibility(){const e=document.querySelector("#pTitle"),t=new MouseEvent("mouseover",{bubbles:!0,cancelable:!1,view:window}),a=new MouseEvent("mouseout",{bubbles:!0,cancelable:!1,view:window}),i=new MouseEvent("click",{bubbles:!0,cancelable:!1,view:window});e.dispatchEvent(t),setTimeout((()=>e.dispatchEvent(i)),200),e.dispatchEvent(a)}updateCards(){gameData.isClickable=!1;let e=document.querySelector(".imgCard"),t=document.querySelector(".p_title"),a=document.querySelector(".p_imgDescri");e.innerHTML="";let i=this.getImage(vocabularyImgDtArr[this.cards[this.cardIdx]].name);e.appendChild(i),i.setAttribute("alt",vocabularyImgDtArr[this.cards[this.cardIdx]].alt),t.innerHTML=vocabulary[this.cards[this.cardIdx]].palavra,a.innerHTML=`${vocabulary[this.cards[this.cardIdx]].descricao}`,gameData.isClickable=!0}setCloseBtn(){const e=document.querySelector(".vpw-header-btn-close"),t=document.querySelector(".vLibrasCard"),a=document.querySelector(".access");console.log(a),e?e.addEventListener("click",(()=>{a.style.display="none!important;",t.style.display="none"})):(this.game.popUpMessage("O botão de fechar não foi encontrado !"),console.error("O botão de fechar não foi encontrado !"))}setSubtitle(){const e=document.querySelector(".vpw-controls-subtitles");e?e.click():this.game.popUpMessage("Botão subtitle não encontrado.")}readWithAccessibility(){const e=document.querySelector("#pTitle"),t=new MouseEvent("mouseover",{bubbles:!0,cancelable:!1,view:window}),a=new MouseEvent("mouseout",{bubbles:!0,cancelable:!1,view:window}),i=new MouseEvent("click",{bubbles:!0,cancelable:!1,view:window});e.dispatchEvent(t),setTimeout((()=>e.dispatchEvent(i)),200),e.dispatchEvent(a)}getImage(e){return gameAssets[e]}}export{Words};