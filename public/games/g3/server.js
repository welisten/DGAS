require("dotenv").config();const{urlencoded}=require("body-parser"),express=require("express"),mainRoute=require("./routes/mainRoute"),cors=require("cors"),vLibrasproxyMiddleware=require("./middlewares/vLibrasProxyMiddleware"),appProxyMiddleware=require("./middlewares/appProxyMiddleware"),helmet=require("helmet"),compression=require("compression"),path=require("path");process.env.PORT&&process.env.APP_ASSETS_PATH||(console.error("Erro: Variáveis de ambiente ausentes!"),process.exit(1));const app=express(),PORT=process.env.PORT||3333;app.use(cors()),app.use(express.static(path.join(__dirname,"public"))),app.use(express.static(path.join(__dirname,"src"))),app.use(express.json()),app.use(urlencoded({extended:!0})),app.use(helmet({contentSecurityPolicy:{directives:{defaultSrc:["'self'"],scriptSrc:["'self'","https://www.vlibras.gov.br","https://code.jquery.com","https://cdnjs.cloudflare.com","https://cdn.jsdelivr.net","'unsafe-inline'"],styleSrc:["'self'","'unsafe-inline'","https://cdnjs.cloudflare.com","https://fonts.googleapis.com"],fontSrc:["'self'","https://cdnjs.cloudflare.com","https://fonts.googleapis.com","https://fonts.gstatic.com"],imgSrc:["'self'","data:","blob:","https://res.cloudinary.com"],mediaSrc:["'self'","blob:"],connectSrc:["'self'","https://acessos.vlibras.gov.br","https://dicionario2.vlibras.gov.br"],workerSrc:["'self'","blob:"]}}})),app.use(compression()),app.use("/",mainRoute),app.get("/env",((e,s)=>{s.json({ASSETS_PATH:process.env.APP_ASSETS_PATH,PORT})})),app.use(vLibrasproxyMiddleware),app.use("/app",appProxyMiddleware),app.listen(PORT,(()=>console.log(`TESOUROS HISTÓRICOS RODANDO NA PORTA ${PORT} \n`)));