import{platformData}from"../../../Constants/platformData.js";import{gameData}from"../Constants/gameData.js";import{colors}from"../Constants/colors.js";import{setLightModeSlider}from"../../../util/navigation.js";const muteBtn=document.querySelector("#muteBtn"),accessBtn=document.querySelector("#accessBtn"),popUp=document.querySelector("#popUpMessage"),popUpCloseBtn=document.querySelector("#popUpBtn"),infoBtn=document.querySelector("#infoBtn"),infoCloseBtn=document.querySelector("#info-close"),audioContext=new(window.AudioContext||window.webkitAudioContext),gainNode=audioContext.createGain(),currentAudios={},info=document.querySelector("#info"),i_body=document.querySelectorAll(".i-body"),i_navBtns=document.querySelectorAll(".i-navBtn"),toggleVolume=()=>{if(gameData.isMute=!gameData.isMute,console.log(currentAudios),gameData.isMute)for(let e in currentAudios)currentAudios[e].config.gainNode.gain.value=0;else for(let e in currentAudios){let t=currentAudios[e].config.volume;currentAudios[e].config.gainNode.gain.value=t}muteBtn.children[0].classList.toggle("fa-volume-xmark"),muteBtn.children[0].classList.toggle("fa-volume-high"),console.log("Volume alternado")},updateAccessibility=()=>{const e=document.documentElement.style,t=document.querySelector("#popUpMessage");if(gameData.isAccess=!gameData.isAccess,gameData.isAccess){accessBtn.children[0].classList.toggle("fa-eye",gameData.isAccess),accessBtn.children[0].classList.toggle("fa-eye-slash",!gameData.isAccess),e.setProperty("--yellow-focus--",colors.yellowFocus);const t=document.querySelector("#popUpBtn");t&&t.remove()}else{e.setProperty("--yellow-focus--",colors.transparent),accessBtn.children[0].classList.toggle("fa-eye-slash",!gameData.isAccess),accessBtn.children[0].classList.toggle("fa-eye",gameData.isAccess);let o=document.querySelector("#popUpBtn");if(!o){o=document.createElement("button");const e=document.createElement("i");o.className="popup_btn",o.id="popUpBtn",o.setAttribute("title","Clique para fechar o alerta"),o.setAttribute("aria-label","Fechar alerta"),e.className="fa-solid fa-xmark",o.append(e),t.append(o),o.addEventListener("click",handleClosePopUp)}}console.log("Acessibilidade alternada")},activeGameInformationBoard=()=>{let e,t,o;if(!info.classList.contains("active")){if(e=document.querySelector(".t-text"),t=document.querySelector(".body-g"),o=document.querySelector(".body-p"),"Game"===gameData.mainScene){o.classList.add("active"),t.classList.remove("active");const e=document.querySelector("#hm_initialMessage"),a=document.querySelector(".hm_sampleTable");e&&e.setAttribute("inert",""),a&&a.setAttribute("inert","")}else o.classList.remove("active"),t.classList.add("active");info.classList.toggle("active"),info.setAttribute("aria-expanded",!0),gameData.isAccess&&e.focus()}},closeInformationBoard=()=>{if(!document.querySelector("#info").classList.contains("active"))return void console.log("Abra as informaçoes antes");const e=document.querySelector("#hm_initialMessage"),t=document.querySelector(".hm_sampleTable"),o=document.querySelector("[hm-initialFocus]");e&&e.removeAttribute("inert"),t&&t.removeAttribute("inert"),gameData.isAccess&&(document.querySelector("#textToReader").textContent="Instruções fechadas",o&&setTimeout((()=>o.focus()),50));const a=document.querySelector("#info");a.classList.toggle("active"),a.setAttribute("aria-expanded",!1)},toggleInfoSections=()=>{if(!info.classList.contains("active"))return;let e=document.querySelectorAll(".i-b0");i_body.forEach((e=>e.classList.toggle("active"))),gameData.isAccess&&e.forEach((e=>{"none"!==e.style.display&&e.focus()}))},handleClosePopUp=()=>{popUp.style.display="none",popUp.style.opacity=0,console.log("dentro"),popUp.classList.toggle("animated",!popUp.classList.contains("animated")),popUp.setAttribute("hidden","")};function setIcons(){muteBtn.children[0].classList.toggle("fa-volume-xmark",gameData.isMute),muteBtn.children[0].classList.toggle("fa-volume-high",!gameData.isMute),accessBtn.children[0].classList.toggle("fa-eye-slash",!gameData.isAccess),accessBtn.children[0].classList.toggle("fa-eye",gameData.isAccess)}function updateGameData(){gameData.isAccess=platformData.isAccess,gameData.isDarkMode=platformData.isDarkMode;const e=document.documentElement.style;e.setProperty("--yellow-focus--",gameData.isAccess?colors.yellowFocus:colors.transparent),e.setProperty("--bg--",gameData.isDarkMode?colors.bg_dark:colors.bg_light);document.querySelector("#accessBtn").children[0].className=gameData.isAccess?"fa-regular fa-eye":"fa-regular fa-eye-slash"}setIcons(),setLightModeSlider(),muteBtn?.addEventListener("click",toggleVolume),accessBtn?.addEventListener("click",updateAccessibility),infoBtn.addEventListener("click",activeGameInformationBoard),infoCloseBtn.addEventListener("click",closeInformationBoard),i_navBtns.forEach((e=>{e.addEventListener("click",toggleInfoSections)})),document.addEventListener("keydown",(e=>{["ArrowLeft","ArrowRight"].includes(e.key)&&(e.preventDefault(),toggleInfoSections())})),popUpCloseBtn?.addEventListener("click",handleClosePopUp);export{gainNode,audioContext,currentAudios,updateGameData};